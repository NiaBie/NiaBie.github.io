<!-- 通用模板 -->

<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <!-- jquery -->
  <script src="https://apps.bdimg.com/libs/jquery/1.10.2/jquery.min.js"></script>
  <script src="https://apps.bdimg.com/libs/jqueryui/1.10.4/jquery-ui.min.js"></script>

  
<link rel="stylesheet" href="/css/main.css">

<meta name="generator" content="Hexo 5.0.0"></head>

<body onload="my_load()"">

  <div class="web_name_box">
    
  </div>
  
  <!-- 顶部菜单栏 -->

<div class="menu_box shadow_box">
  <div class="menu_item_box left" id="menu_preview">preview</div>
  <div class="menu_item_box left" id="menu_tags">tags</div>
  <div class="menu_item_box left" id="menu_categories">categories</div>

  <div class="search_input_box left" id="search_input_box">
    <input type="search" placeholder="" id="search_input" class="search_input">
  </div>

  <div class="menu_item_box right" id="menu_next">next</div>
  
    <div class="menu_item_box right" id="menu_guide">guide</div>
  
  <div class="menu_item_box right" id="menu_site">sites</div>
</div>

<div class="tag_box shadow_box" id="tag_box"></div>

<div class="category_box shadow_box" id="category_box"></div>

<div class="site_box shadow_box" id="site_box">
  <span class="site_item">
    <a href="/">home</a>
  </span>
  <span class="site_item">
    <a href="/archives">archives</a>
  </span>
  <span class="site_item">
    <a target="_blank" rel="noopener" href="https://github.com/NiaBie">github</a>
  </span>
  <span class="site_item">
    <a href="/knife">knives</a>
  </span>
  <span class="site_item">
    <a href="/friends">links</a>
  </span>
</div>


  <!-- 附加导航 -->
  <div class="guide_box shadow_box" id="guide_box">
    <div class="tag_list_box" id="tag_list_box">
      <span class="guide_item">tags</span>
      
        
          <span class="tag_item">
            <a href="/tags/android-studio/">android studio</a>
          </span>
        
          <span class="tag_item">
            <a href="/tags/android/">android</a>
          </span>
        
          <span class="tag_item">
            <a href="/tags/java/">java</a>
          </span>
        
          <span class="tag_item">
            <a href="/tags/cmake/">cmake</a>
          </span>
        
          <span class="tag_item">
            <a href="/tags/ffmpeg/">ffmpeg</a>
          </span>
        
          <span class="tag_item">
            <a href="/tags/opencv/">opencv</a>
          </span>
        
          <span class="tag_item">
            <a href="/tags/ndk/">ndk</a>
          </span>
        
          <span class="tag_item">
            <a href="/tags/gradle/">gradle</a>
          </span>
        
          <span class="tag_item">
            <a href="/tags/javacv/">javacv</a>
          </span>
        
      
    </div>

    <div class="line_box" id="guide_line_box"></div>
    <style>
      #guide_line_box {
        width: 90%;
      }
    </style>
    
    <div class="category_list_box" id="category_list_box">
      <span class="guide_item">categories</span>
      
        
      
    </div>

    <div class="guide_list_box border_box" id="guide_list_box"></div>
  </div>


<div class="search_result_box shadow_box" id="search_result_box">
  <div id="search_filter" class="search_list_box">
    <span id="search_filter_1" class="search_item">
      <a>only title</a>
    </span>
    <span id="search_filter_2" class="search_item">
      <a>title and content</a>
    </span>
  </div>
  <div id="search_result_list" class="search_result_list"></div>
</div>



<script>
  tags_name = new Array();
  tags_path = new Array();

  ''
    var temp = 'sage';
    tags_name.push(temp);
    temp = 'tags/sage/';
    tags_path.push(temp);
  ''
    var temp = 'python';
    tags_name.push(temp);
    temp = 'tags/python/';
    tags_path.push(temp);
  ''
    var temp = 'android studio';
    tags_name.push(temp);
    temp = 'tags/android-studio/';
    tags_path.push(temp);
  ''
    var temp = 'android';
    tags_name.push(temp);
    temp = 'tags/android/';
    tags_path.push(temp);
  ''
    var temp = 'adb';
    tags_name.push(temp);
    temp = 'tags/adb/';
    tags_path.push(temp);
  ''
    var temp = 'java';
    tags_name.push(temp);
    temp = 'tags/java/';
    tags_path.push(temp);
  ''
    var temp = 'cubism';
    tags_name.push(temp);
    temp = 'tags/cubism/';
    tags_path.push(temp);
  ''
    var temp = 'javascript';
    tags_name.push(temp);
    temp = 'tags/javascript/';
    tags_path.push(temp);
  ''
    var temp = 'live2d';
    tags_name.push(temp);
    temp = 'tags/live2d/';
    tags_path.push(temp);
  ''
    var temp = 'typescript';
    tags_name.push(temp);
    temp = 'tags/typescript/';
    tags_path.push(temp);
  ''
    var temp = 'npm';
    tags_name.push(temp);
    temp = 'tags/npm/';
    tags_path.push(temp);
  ''
    var temp = 'linux';
    tags_name.push(temp);
    temp = 'tags/linux/';
    tags_path.push(temp);
  ''
    var temp = 'powerline';
    tags_name.push(temp);
    temp = 'tags/powerline/';
    tags_path.push(temp);
  ''
    var temp = 'zsh';
    tags_name.push(temp);
    temp = 'tags/zsh/';
    tags_path.push(temp);
  ''
    var temp = 'vim';
    tags_name.push(temp);
    temp = 'tags/vim/';
    tags_path.push(temp);
  ''
    var temp = 'git';
    tags_name.push(temp);
    temp = 'tags/git/';
    tags_path.push(temp);
  ''
    var temp = 'pip';
    tags_name.push(temp);
    temp = 'tags/pip/';
    tags_path.push(temp);
  ''
    var temp = 'gnome';
    tags_name.push(temp);
    temp = 'tags/gnome/';
    tags_path.push(temp);
  ''
    var temp = 'c';
    tags_name.push(temp);
    temp = 'tags/c/';
    tags_path.push(temp);
  ''
    var temp = 'makefile';
    tags_name.push(temp);
    temp = 'tags/makefile/';
    tags_path.push(temp);
  ''
    var temp = 'PyQt5';
    tags_name.push(temp);
    temp = 'tags/PyQt5/';
    tags_path.push(temp);
  ''
    var temp = 'qt';
    tags_name.push(temp);
    temp = 'tags/qt/';
    tags_path.push(temp);
  ''
    var temp = 'cpp';
    tags_name.push(temp);
    temp = 'tags/cpp/';
    tags_path.push(temp);
  ''
    var temp = 'deb';
    tags_name.push(temp);
    temp = 'tags/deb/';
    tags_path.push(temp);
  ''
    var temp = 'debreate';
    tags_name.push(temp);
    temp = 'tags/debreate/';
    tags_path.push(temp);
  ''
    var temp = '华为';
    tags_name.push(temp);
    temp = 'tags/华为/';
    tags_path.push(temp);
  ''
    var temp = 'php';
    tags_name.push(temp);
    temp = 'tags/php/';
    tags_path.push(temp);
  ''
    var temp = 'apahce2';
    tags_name.push(temp);
    temp = 'tags/apahce2/';
    tags_path.push(temp);
  ''
    var temp = 'latex';
    tags_name.push(temp);
    temp = 'tags/latex/';
    tags_path.push(temp);
  ''
    var temp = 'html';
    tags_name.push(temp);
    temp = 'tags/html/';
    tags_path.push(temp);
  ''
    var temp = 'css';
    tags_name.push(temp);
    temp = 'tags/css/';
    tags_path.push(temp);
  ''
    var temp = 'bucket';
    tags_name.push(temp);
    temp = 'tags/bucket/';
    tags_path.push(temp);
  ''
    var temp = '七牛云';
    tags_name.push(temp);
    temp = 'tags/七牛云/';
    tags_path.push(temp);
  ''
    var temp = 'cdn';
    tags_name.push(temp);
    temp = 'tags/cdn/';
    tags_path.push(temp);
  ''
    var temp = 'chrome';
    tags_name.push(temp);
    temp = 'tags/chrome/';
    tags_path.push(temp);
  ''
    var temp = 'qqbrowser';
    tags_name.push(temp);
    temp = 'tags/qqbrowser/';
    tags_path.push(temp);
  ''
    var temp = 'cmake';
    tags_name.push(temp);
    temp = 'tags/cmake/';
    tags_path.push(temp);
  ''
    var temp = '正则表达式';
    tags_name.push(temp);
    temp = 'tags/正则表达式/';
    tags_path.push(temp);
  ''
    var temp = 'http';
    tags_name.push(temp);
    temp = 'tags/http/';
    tags_path.push(temp);
  ''
    var temp = 'eigen';
    tags_name.push(temp);
    temp = 'tags/eigen/';
    tags_path.push(temp);
  ''
    var temp = 'ffmpeg';
    tags_name.push(temp);
    temp = 'tags/ffmpeg/';
    tags_path.push(temp);
  ''
    var temp = 'opencv';
    tags_name.push(temp);
    temp = 'tags/opencv/';
    tags_path.push(temp);
  ''
    var temp = 'ndk';
    tags_name.push(temp);
    temp = 'tags/ndk/';
    tags_path.push(temp);
  ''
    var temp = 'gcc';
    tags_name.push(temp);
    temp = 'tags/gcc/';
    tags_path.push(temp);
  ''
    var temp = 'assemly';
    tags_name.push(temp);
    temp = 'tags/assemly/';
    tags_path.push(temp);
  ''
    var temp = 'gdb';
    tags_name.push(temp);
    temp = 'tags/gdb/';
    tags_path.push(temp);
  ''
    var temp = 'ssh';
    tags_name.push(temp);
    temp = 'tags/ssh/';
    tags_path.push(temp);
  ''
    var temp = 'windows';
    tags_name.push(temp);
    temp = 'tags/windows/';
    tags_path.push(temp);
  ''
    var temp = 'grub';
    tags_name.push(temp);
    temp = 'tags/grub/';
    tags_path.push(temp);
  ''
    var temp = 'hexo';
    tags_name.push(temp);
    temp = 'tags/hexo/';
    tags_path.push(temp);
  ''
    var temp = 'swig';
    tags_name.push(temp);
    temp = 'tags/swig/';
    tags_path.push(temp);
  ''
    var temp = 'ejs';
    tags_name.push(temp);
    temp = 'tags/ejs/';
    tags_path.push(temp);
  ''
    var temp = 'mathjax';
    tags_name.push(temp);
    temp = 'tags/mathjax/';
    tags_path.push(temp);
  ''
    var temp = 'katex';
    tags_name.push(temp);
    temp = 'tags/katex/';
    tags_path.push(temp);
  ''
    var temp = '阿里云';
    tags_name.push(temp);
    temp = 'tags/阿里云/';
    tags_path.push(temp);
  ''
    var temp = 'shell';
    tags_name.push(temp);
    temp = 'tags/shell/';
    tags_path.push(temp);
  ''
    var temp = 'jni';
    tags_name.push(temp);
    temp = 'tags/jni/';
    tags_path.push(temp);
  ''
    var temp = 'jsdelivr';
    tags_name.push(temp);
    temp = 'tags/jsdelivr/';
    tags_path.push(temp);
  ''
    var temp = 'jquery';
    tags_name.push(temp);
    temp = 'tags/jquery/';
    tags_path.push(temp);
  ''
    var temp = 'krita';
    tags_name.push(temp);
    temp = 'tags/krita/';
    tags_path.push(temp);
  ''
    var temp = 'mac';
    tags_name.push(temp);
    temp = 'tags/mac/';
    tags_path.push(temp);
  ''
    var temp = 'brew';
    tags_name.push(temp);
    temp = 'tags/brew/';
    tags_path.push(temp);
  ''
    var temp = 'matlab';
    tags_name.push(temp);
    temp = 'tags/matlab/';
    tags_path.push(temp);
  ''
    var temp = 'visual studio';
    tags_name.push(temp);
    temp = 'tags/visual-studio/';
    tags_path.push(temp);
  ''
    var temp = 'csharp';
    tags_name.push(temp);
    temp = 'tags/csharp/';
    tags_path.push(temp);
  ''
    var temp = 'mysql';
    tags_name.push(temp);
    temp = 'tags/mysql/';
    tags_path.push(temp);
  ''
    var temp = 'sql';
    tags_name.push(temp);
    temp = 'tags/sql/';
    tags_path.push(temp);
  ''
    var temp = 'unpkg';
    tags_name.push(temp);
    temp = 'tags/unpkg/';
    tags_path.push(temp);
  ''
    var temp = 'bfs';
    tags_name.push(temp);
    temp = 'tags/bfs/';
    tags_path.push(temp);
  ''
    var temp = 'dfs';
    tags_name.push(temp);
    temp = 'tags/dfs/';
    tags_path.push(temp);
  ''
    var temp = 'dijkstra算法';
    tags_name.push(temp);
    temp = 'tags/dijkstra算法/';
    tags_path.push(temp);
  ''
    var temp = 'dinic算法';
    tags_name.push(temp);
    temp = 'tags/dinic算法/';
    tags_path.push(temp);
  ''
    var temp = 'ek算法';
    tags_name.push(temp);
    temp = 'tags/ek算法/';
    tags_path.push(temp);
  ''
    var temp = 'floyd算法';
    tags_name.push(temp);
    temp = 'tags/floyd算法/';
    tags_path.push(temp);
  ''
    var temp = 'km算法';
    tags_name.push(temp);
    temp = 'tags/km算法/';
    tags_path.push(temp);
  ''
    var temp = 'kmp算法';
    tags_name.push(temp);
    temp = 'tags/kmp算法/';
    tags_path.push(temp);
  ''
    var temp = 'kruskal算法';
    tags_name.push(temp);
    temp = 'tags/kruskal算法/';
    tags_path.push(temp);
  ''
    var temp = 'morris算法';
    tags_name.push(temp);
    temp = 'tags/morris算法/';
    tags_path.push(temp);
  ''
    var temp = 'prim算法';
    tags_name.push(temp);
    temp = 'tags/prim算法/';
    tags_path.push(temp);
  ''
    var temp = 'tarjan算法';
    tags_name.push(temp);
    temp = 'tags/tarjan算法/';
    tags_path.push(temp);
  ''
    var temp = '树的遍历';
    tags_name.push(temp);
    temp = 'tags/树的遍历/';
    tags_path.push(temp);
  ''
    var temp = '匈牙利算法';
    tags_name.push(temp);
    temp = 'tags/匈牙利算法/';
    tags_path.push(temp);
  ''
    var temp = 'orb-slam';
    tags_name.push(temp);
    temp = 'tags/orb-slam/';
    tags_path.push(temp);
  ''
    var temp = 'photoshop';
    tags_name.push(temp);
    temp = 'tags/photoshop/';
    tags_path.push(temp);
  ''
    var temp = '绘画';
    tags_name.push(temp);
    temp = 'tags/绘画/';
    tags_path.push(temp);
  ''
    var temp = 'numpy';
    tags_name.push(temp);
    temp = 'tags/numpy/';
    tags_path.push(temp);
  ''
    var temp = 'sklearn';
    tags_name.push(temp);
    temp = 'tags/sklearn/';
    tags_path.push(temp);
  ''
    var temp = 'matplotlib';
    tags_name.push(temp);
    temp = 'tags/matplotlib/';
    tags_path.push(temp);
  ''
    var temp = '反编译';
    tags_name.push(temp);
    temp = 'tags/反编译/';
    tags_path.push(temp);
  ''
    var temp = 'slenium';
    tags_name.push(temp);
    temp = 'tags/slenium/';
    tags_path.push(temp);
  ''
    var temp = 'phantomjs';
    tags_name.push(temp);
    temp = 'tags/phantomjs/';
    tags_path.push(temp);
  ''
    var temp = 'rss';
    tags_name.push(temp);
    temp = 'tags/rss/';
    tags_path.push(temp);
  ''
    var temp = 'xml';
    tags_name.push(temp);
    temp = 'tags/xml/';
    tags_path.push(temp);
  ''
    var temp = '爬虫';
    tags_name.push(temp);
    temp = 'tags/爬虫/';
    tags_path.push(temp);
  ''
    var temp = 'ajax';
    tags_name.push(temp);
    temp = 'tags/ajax/';
    tags_path.push(temp);
  ''
    var temp = 'termux';
    tags_name.push(temp);
    temp = 'tags/termux/';
    tags_path.push(temp);
  ''
    var temp = '内网穿透';
    tags_name.push(temp);
    temp = 'tags/内网穿透/';
    tags_path.push(temp);
  ''
    var temp = 'stitch';
    tags_name.push(temp);
    temp = 'tags/stitch/';
    tags_path.push(temp);
  ''
    var temp = 'sublime';
    tags_name.push(temp);
    temp = 'tags/sublime/';
    tags_path.push(temp);
  ''
    var temp = 'svg';
    tags_name.push(temp);
    temp = 'tags/svg/';
    tags_path.push(temp);
  ''
    var temp = 'tmux';
    tags_name.push(temp);
    temp = 'tags/tmux/';
    tags_path.push(temp);
  ''
    var temp = 'ubuntu';
    tags_name.push(temp);
    temp = 'tags/ubuntu/';
    tags_path.push(temp);
  ''
    var temp = 'wlan';
    tags_name.push(temp);
    temp = 'tags/wlan/';
    tags_path.push(temp);
  ''
    var temp = 'midi';
    tags_name.push(temp);
    temp = 'tags/midi/';
    tags_path.push(temp);
  ''
    var temp = 'lol';
    tags_name.push(temp);
    temp = 'tags/lol/';
    tags_path.push(temp);
  ''
    var temp = 'hyper';
    tags_name.push(temp);
    temp = 'tags/hyper/';
    tags_path.push(temp);
  ''
    var temp = 'vpn';
    tags_name.push(temp);
    temp = 'tags/vpn/';
    tags_path.push(temp);
  ''
    var temp = 'shadowsocks';
    tags_name.push(temp);
    temp = 'tags/shadowsocks/';
    tags_path.push(temp);
  ''
    var temp = 'ssr';
    tags_name.push(temp);
    temp = 'tags/ssr/';
    tags_path.push(temp);
  ''
    var temp = '驱动';
    tags_name.push(temp);
    temp = 'tags/驱动/';
    tags_path.push(temp);
  ''
    var temp = 'unity';
    tags_name.push(temp);
    temp = 'tags/unity/';
    tags_path.push(temp);
  ''
    var temp = 'vlfeat';
    tags_name.push(temp);
    temp = 'tags/vlfeat/';
    tags_path.push(temp);
  ''
    var temp = 'vscode';
    tags_name.push(temp);
    temp = 'tags/vscode/';
    tags_path.push(temp);
  ''
    var temp = 'vundle';
    tags_name.push(temp);
    temp = 'tags/vundle/';
    tags_path.push(temp);
  ''
    var temp = 'wegame';
    tags_name.push(temp);
    temp = 'tags/wegame/';
    tags_path.push(temp);
  ''
    var temp = 'mathematica';
    tags_name.push(temp);
    temp = 'tags/mathematica/';
    tags_path.push(temp);
  ''
    var temp = 'wordpress';
    tags_name.push(temp);
    temp = 'tags/wordpress/';
    tags_path.push(temp);
  ''
    var temp = 'apache';
    tags_name.push(temp);
    temp = 'tags/apache/';
    tags_path.push(temp);
  ''
    var temp = 'xampp';
    tags_name.push(temp);
    temp = 'tags/xampp/';
    tags_path.push(temp);
  ''
    var temp = '帧同步';
    tags_name.push(temp);
    temp = 'tags/帧同步/';
    tags_path.push(temp);
  ''
    var temp = '航位推算';
    tags_name.push(temp);
    temp = 'tags/航位推算/';
    tags_path.push(temp);
  ''
    var temp = '百度网盘';
    tags_name.push(temp);
    temp = 'tags/百度网盘/';
    tags_path.push(temp);
  ''
    var temp = 'sai';
    tags_name.push(temp);
    temp = 'tags/sai/';
    tags_path.push(temp);
  ''
    var temp = 'medibang paint';
    tags_name.push(temp);
    temp = 'tags/medibang-paint/';
    tags_path.push(temp);
  ''
    var temp = 'gradle';
    tags_name.push(temp);
    temp = 'tags/gradle/';
    tags_path.push(temp);
  ''
    var temp = 'javacv';
    tags_name.push(temp);
    temp = 'tags/javacv/';
    tags_path.push(temp);
  ''
    var temp = '微电子';
    tags_name.push(temp);
    temp = 'tags/微电子/';
    tags_path.push(temp);
  ''
  // 因为path和name只有前缀不同,所以分别排序之后相对顺序还是一样的
  tags_name.sort();
  tags_path.sort();
  for (var i = 0; i < tags_name.length; i ++)
  {
    $("#tag_box").append("<span class='tag_item'><a href='/" + tags_path[i] + "'>" + tags_name[i] + "</a></span>\n");
  }


  categories_name = new Array();
  categories_path = new Array();

  ''
    var temp = '问题求解';
    categories_name.push(temp);
    temp = 'categories/问题求解/';
    categories_path.push(temp);
  ''
    var temp = '操作系统';
    categories_name.push(temp);
    temp = 'categories/操作系统/';
    categories_path.push(temp);
  ''
    var temp = '人工智能';
    categories_name.push(temp);
    temp = 'categories/人工智能/';
    categories_path.push(temp);
  ''
    var temp = '微电子';
    categories_name.push(temp);
    temp = 'categories/微电子/';
    categories_path.push(temp);
  ''
    var temp = '数据库';
    categories_name.push(temp);
    temp = 'categories/数据库/';
    categories_path.push(temp);
  ''
    var temp = '数据通信';
    categories_name.push(temp);
    temp = 'categories/数据通信/';
    categories_path.push(temp);
  ''
    var temp = '数理逻辑';
    categories_name.push(temp);
    temp = 'categories/数理逻辑/';
    categories_path.push(temp);
  ''
    var temp = '概率论与数理统计';
    categories_name.push(temp);
    temp = 'categories/概率论与数理统计/';
    categories_path.push(temp);
  ''
    var temp = '计算机网络';
    categories_name.push(temp);
    temp = 'categories/计算机网络/';
    categories_path.push(temp);
  ''
  // 因为path和name只有前缀不同,所以分别排序之后相对顺序还是一样的
  categories_name.sort();
  categories_path.sort();
  for (var i = 0; i < categories_name.length; i ++)
  {
    $("#category_box").append("<span class='category_item'><a href='/" + categories_path[i] + "'>" + categories_name[i] + "</a></span>\n");
  }
</script>

<script>
  // TODO 搜索
</script>
  <!-- latex公式渲染 -->



<script>
  document.temp_latex = '1';// 全局变量,latex公式渲染方式
</script>


<!-- mathjax -->
<script type="text/x-mathjax-config">
  console.log("mathjax rendering");
  
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [
        ['$','$']
      ],
      displayMath: [
        ['$$', '$$']
      ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {  
      noUndefined: { 
        attributes: { 
          mathcolor: "red",
          mathbackground: "#FFEEEE",
          mathsize: "10%"
        } 
      }
    }
  });

  MathJax.Hub.Queue(["Typeset", MathJax.Hub])
</script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/hexo-simple-theme/hexo_latex@1.0.4/mathjax/MathJax.js?config=TeX-AMS_HTML-full"></script>
<script>
  console.log("mathjax rendering");
</script>


  <!-- 文章 -->

<div class="main_container">
  <div class="main_box border_box">
    <span class="post_title" id="post_title">openCV安装</span>
    <br>
    <span class="post_date">2019-10-21</span>
    
    <div class="line_box" id="post_line_box"></div>
    <style>
      #post_line_box {
        width: 100%;
        margin-top: 10px;
      }
    </style>
  
    <h1 id="AS和cmake笔记"><a href="#AS和cmake笔记" class="headerlink" title="AS和cmake笔记"></a>AS和cmake笔记</h1><h2 id="android的cpu架构"><a href="#android的cpu架构" class="headerlink" title="android的cpu架构"></a>android的cpu架构</h2><ul>
<li>android查看cpu架构(<code>termux</code>)</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cat /proc/cpuinfo</span><br></pre></td></tr></table></figure>

<ul>
<li><code>AArch32</code>是<code>ARMv7</code>架构的一种执行状态</li>
<li><code>AArch64</code>是<code>ARMv8</code>架构的一种执行状态<ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/rd_w_csdn/article/details/53841018">参考</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/mao520741111/article/details/50328669">参考</a></li>
</ul>
</li>
<li>64位<code>ARMv8</code>包含上面两种状态<ul>
<li><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1443783">参考</a></li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/23102158">知乎</a></li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/21359984">知乎</a></li>
</ul>
</li>
</ul>
<h2 id="cmake在AS中的使用"><a href="#cmake在AS中的使用" class="headerlink" title="cmake在AS中的使用"></a>cmake在AS中的使用</h2><p>不要把<code>mk</code>和<code>cmake</code>两种方法混淆</p>
<h3 id="输出控制-message"><a href="#输出控制-message" class="headerlink" title="输出控制(message)"></a>输出控制(<code>message</code>)</h3><blockquote>
<p>(TODO)如果想直接看到打印信息,使用<code>WARNING</code>以上的级别进行打印</p>
</blockquote>
<ul>
<li><code>message(WARNING &quot;fuck&quot;)</code><ul>
<li>在<code>Build</code>-&gt;<code>Build Output</code>-&gt;<code>CMake warnings</code>查看</li>
<li>在<code>Build</code>-&gt;<code>Build Output</code>-&gt;<code>Toggle View</code>查看</li>
</ul>
</li>
</ul>
<h1 id="Android"><a href="#Android" class="headerlink" title="Android"></a>Android</h1><ul>
<li>版本信息<ul>
<li><code>Android Studio</code>版本为3.5</li>
<li><code>Build-Tools</code>版本为28.0.3</li>
</ul>
</li>
<li>需要使用<code>SDK Manager</code>安装<ul>
<li>ndk</li>
<li>cmake</li>
</ul>
</li>
</ul>
<h2 id="只使用java模块"><a href="#只使用java模块" class="headerlink" title="只使用java模块"></a>只使用<code>java</code>模块</h2><h3 id="3-x-3-4-7-3-x版本"><a href="#3-x-3-4-7-3-x版本" class="headerlink" title="3.x-3.4.7-3.x版本"></a><code>3.x</code>-<code>3.4.7</code>-<code>3.x</code>版本</h3><ol>
<li><code>File</code>-&gt;<code>New</code>-&gt;<code>Import Module</code>-&gt;选择opencv文件夹下的<code>sdk/java</code>文件夹,此时<code>Android Studio</code>会自动加载<code>Module name</code></li>
<li>将<code>opencv</code>模块的<code>AndroidManifest.xml</code>中<code>&lt;uses-sdk android:minSdkVersion=&quot;8&quot; android:targetSdkVersion=&quot;21&quot; /&gt;</code>删除</li>
<li><code>File</code>-&gt;<code>Project Structure</code>-&gt;<code>Dependencies</code>-&gt;选择<code>app</code>-&gt;添加<code>Module Dependency</code>-&gt;选择opencv</li>
<li>将opencv文件夹下的<code>sdk/native/libs</code>下自己手机cpu对应的架构文件夹复制到<code>app/libs</code>下</li>
<li>将opencv模块的<code>build.gradle</code>的<code>complieSdkVersion</code>,<code>buildToolVersion</code>,<code>minSdkVersion</code>,<code>targetSdkVersion</code>改成和<code>app</code>的<code>build.gradle</code>一样</li>
<li>在<code>app</code>的<code>build.gradle</code>的<code>android</code>节点下添加<figure class="highlight gradle"><table><tr><td class="code"><pre><span class="line"><span class="keyword">sourceSets</span> &#123;</span><br><span class="line">  main &#123;</span><br><span class="line">    jni.srcDirs = []</span><br><span class="line">    jniLibs.srcDirs = [<span class="string">&#x27;libs&#x27;</span>]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
然后点击<code>sync now</code></li>
<li>在使用opencv前进行初始化<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">static</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (!OpenCVLoader.initDebug()) &#123;</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="常见错误"><a href="#常见错误" class="headerlink" title="常见错误"></a>常见错误</h3><ol>
<li><code>Caused by: CvException [org.opencv.core.CvException: OpenCV(4.1.1) /build/master_pack-android/opencv/modules/java/generator/src/cpp/utils.cpp:101: error: (-215:Assertion failed)</code></li>
</ol>
<p>在<code>Mat</code>与<code>Bitmap</code>互转的时候长宽设置不对</p>
<h2 id="只使用native模块"><a href="#只使用native模块" class="headerlink" title="只使用native模块"></a>只使用<code>native</code>模块</h2><h3 id="3-x-3-4-7-3-x版本-1"><a href="#3-x-3-4-7-3-x版本-1" class="headerlink" title="3.x-3.4.7-3.x版本"></a><code>3.x</code>-<code>3.4.7</code>-<code>3.x</code>版本</h3><h4 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h4><ol>
<li><code>CMakeLists.txt</code>编写<ol>
<li>include头文件目录</li>
<li>加载libopencv动态库(<code>libopencv_world</code>或<code>libopencv_java3</code>),命名为<code>opencv_lib</code></li>
<li>将<code>opencv_lib</code>加载至目标文件</li>
</ol>
</li>
</ol>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="keyword">set</span>(opencv_dir /home/lynx/fuck_mount/opencv/build_dir/<span class="number">4</span>_1_0_shared/OpenCV-android-sdk)</span><br><span class="line"><span class="keyword">set</span>(opencv_lib libopencv_world.so) <span class="comment"># 或libopencv_java3.so</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include_directories</span>(<span class="variable">$&#123;opencv_dir&#125;</span>/sdk/native/jni/<span class="keyword">include</span>)</span><br><span class="line"><span class="keyword">add_library</span>(opencv_lib SHARED IMPORTED)</span><br><span class="line"><span class="keyword">set_target_properties</span>(opencv_lib PROPERTIES IMPORTED_LOCATION</span><br><span class="line">    <span class="variable">$&#123;opencv_dir&#125;</span>/sdk/native/libs/<span class="variable">$&#123;ANDROID_ABI&#125;</span>/<span class="variable">$&#123;opencv_lib&#125;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">target_link_libraries</span>(</span><br><span class="line">        <span class="comment"># 目标文件</span></span><br><span class="line"></span><br><span class="line">        opencv_lib</span><br><span class="line">        <span class="comment"># 其他库 )</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>修改app的<code>build.gradle</code><ul>
<li>在<code>android</code>节点下插入,否则会报错找不到<code>libopencv_world.so</code>或<code>libopencv_java3.so</code></li>
</ul>
</li>
</ol>
<figure class="highlight gradle"><table><tr><td class="code"><pre><span class="line"><span class="keyword">sourceSets</span> &#123;</span><br><span class="line">  main &#123;</span><br><span class="line">    jniLibs.srcDirs = [<span class="string">&#x27;/sdk/native/libs 对应目录&#x27;</span>]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h4><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/u010677365/article/details/76922541">参考:CSDN</a></p>
<ol>
<li><code>CMakeLists.txt</code><ol>
<li>设置OpenCV查找的目录</li>
<li>查找OpenCV</li>
<li>include头文件目录</li>
<li>将OpenCV的库添加至目标文件</li>
</ol>
</li>
</ol>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="keyword">set</span>(sdk_dir /home/lynx/fuck_mount/opencv/build_dir/<span class="number">4</span>_1_0_shared)</span><br><span class="line"><span class="keyword">set</span>(OpenCV_DIR <span class="variable">$&#123;sdk_dir&#125;</span>/OpenCV-android-sdk/sdk/native/jni)</span><br><span class="line"><span class="keyword">find_package</span>(OpenCV REQUIRED)</span><br><span class="line"><span class="keyword">include_directories</span>(<span class="variable">$&#123;sdk_dir&#125;</span>/OpenCV-android-sdk/sdk/native/jni/<span class="keyword">include</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">target_link_libraries</span>( </span><br><span class="line">                       <span class="comment"># 目标文件</span></span><br><span class="line"></span><br><span class="line">                       <span class="variable">$&#123;OpenCV_LIBS&#125;</span></span><br><span class="line">                       <span class="comment"># 其他库 )</span></span><br></pre></td></tr></table></figure>

<ul>
<li>如果不设置<code>OpenCV_DIR</code>将无法查找<code>OpenCV</code>包</li>
</ul>
<ol start="2">
<li>修改app的<code>build.gradle</code></li>
</ol>
<figure class="highlight gradle"><table><tr><td class="code"><pre><span class="line"><span class="keyword">sourceSets</span> &#123;</span><br><span class="line">  main &#123;</span><br><span class="line">    jniLibs.srcDirs = [<span class="string">&#x27;/home/lynx/fuck_mount/opencv/build_dir/4_1_0_shared/OpenCV-android-sdk/sdk/native/libs&#x27;</span>]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>此外,务必将<code>minSdkVersion</code>调至<strong>21</strong>以上,否则将会只有<code>v8a</code>架构才能成功编译</li>
<li>在app的<code>build.gradle</code>中:<code>minSdkVersion</code>-&gt;<code>ANDROID_PLATFORM</code></li>
<li>在<code>ndk</code>的<code>android.toolchain.cmake</code>中:<code>ANDROID_PLATFORM</code>-&gt;<code>ANDROID_PLATFORM_LEVEL</code>-&gt;<code>ANDROID_NATIVE_API_LEVEL</code></li>
<li>如果不设置<code>minSdkVersion</code>,由于以上的确定关系,<code>ANDROID_NATIVE_API_LEVEL</code>会被设置为16,<code>find_package</code>会失败</li>
</ul>
<h3 id="4-x-4-1-0-4-x版本"><a href="#4-x-4-1-0-4-x版本" class="headerlink" title="4.x-4.1.0-4.x版本"></a><code>4.x</code>-<code>4.1.0</code>-<code>4.x</code>版本</h3><h4 id="方法一-1"><a href="#方法一-1" class="headerlink" title="方法一"></a>方法一</h4><p>同<code>3.x</code>版本的<code>方法一</code></p>
<h4 id="方法二-1"><a href="#方法二-1" class="headerlink" title="方法二"></a>方法二</h4><p>同<code>3.x</code>版本的<code>方法二</code></p>
<h3 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h3><ol>
<li><code>java.lang.UnsatisfiedLinkError: dlopen failed: library &quot;libc++_shared.so&quot; not found</code>(<code>4.x</code>版本)</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/39620739/android-studio-cmake-shared-library-missing-libc-shared-so-can-cmake-bundle">stackoverflow</a></p>
<p>(不确定的解决方法)在app的gradle中修改</p>
<figure class="highlight gradle"><table><tr><td class="code"><pre><span class="line">externalNativeBuild &#123;</span><br><span class="line">  cmake &#123;</span><br><span class="line">    cppFlags <span class="string">&quot;&quot;</span></span><br><span class="line">      arguments <span class="string">&quot;-DANDROID_STL=c++_shared&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>不要使用<code>gnustl_shared</code>或<code>gnustl_static</code>,已经过时</p>
<ol start="2">
<li><code>java.lang.UnsatisfiedLinkError: dlopen failed: library &quot;libopencv_java3.so&quot; not found</code>(或<code>libopencv_java4.so</code>)</li>
</ol>
<p>这是由于忘记了上面的第2步.Android Studio默认的<code>jni</code>路径为<code>app/src/main/jniLibs</code>,除了在<code>CMakeLists.txt</code>中导入opencv的库以外还需要二选一</p>
<ul>
<li>将对应版本opencv的库(<code>libs/</code>下一级的各个<code>$&#123;ANDROID_ABI&#125;</code>文件夹)移动到<code>jniLibs</code>下</li>
<li>在<code>build.gradle</code>中修改默认<code>jni</code>路径(见上面第2步)</li>
</ul>
<ol start="3">
<li>各种<code>undefined reference to *</code>(<code>3.x</code>版本)</li>
</ol>
<p>如<code>std::ios_base::Init::Init()</code>等</p>
<p><strong>TODO</strong></p>
<ol start="4">
<li>各类<code>AndroidBitmap</code>的问题(<code>3.x</code>版本)</li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">undefined reference to &#96;AndroidBitmap_getInfo&#39;</span><br></pre></td></tr></table></figure>

<p>在<code>CMakeLists.txt</code>增加</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">target_link_libraries(</span><br><span class="line">        # TODO 解决 AndroidBitmap 报错</span><br><span class="line">        jnigraphics)</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/lj402159806/article/details/69049587">参考:CSDN</a>,这是一个很小的库,展示一个稳定的,基于C语言的接口,使本机代码安全地访问Java对象的像素缓冲区的位图</p>
<h2 id="source-code-使用完整代码"><a href="#source-code-使用完整代码" class="headerlink" title="source code(使用完整代码)"></a>source code(使用完整代码)</h2><h3 id="3-x-3-x版本-未成功-需要eclipse"><a href="#3-x-3-x版本-未成功-需要eclipse" class="headerlink" title="3.x-3.x版本(未成功,需要eclipse)"></a><code>3.x</code>-<code>3.x</code>版本(<strong>未成功</strong>,需要eclipse)</h3><h3 id="4-x-4-1-0-4-x版本-1"><a href="#4-x-4-1-0-4-x版本-1" class="headerlink" title="4.x-4.1.0-4.x版本"></a><code>4.x</code>-<code>4.1.0</code>-<code>4.x</code>版本</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_38743313/article/details/98958207">参考:CSDN</a></p>
<ol>
<li><p>环境变量</p>
<ul>
<li><code>JAVA_HOME</code><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> JAVA_HOME=/home/lynx/fuck_mount/Android_Studio/jre <span class="comment"># 使用Android Studio的JDK位置</span></span><br></pre></td></tr></table></figure></li>
<li><code>ANDROID_SDK</code>(非必须)<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> ANDROID_SDK=/home/lynx/fuck_mount/Android_SDK</span><br></pre></td></tr></table></figure></li>
<li><code>ANDROID_NDK</code>(非必须)<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> ANDROID_NDK=/home/lynx/fuck_mount/Android_SDK/ndk/&#123;版本&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>调整结构</p>
<ul>
<li>修改toolchain:android ndk的<code>ndk/build/cmake/android.toolchain.cmake</code>(约112行)<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="keyword">elseif</span>(ANDROID_TOOLCHAIN_NAME <span class="keyword">MATCHES</span> <span class="string">&quot;-[0-9].[0-9]$&quot;</span>)</span><br><span class="line">  <span class="keyword">set</span>(ANDROID_TOOLCHAIN clang) <span class="comment"># 将gcc改成clang</span></span><br><span class="line"><span class="keyword">endif</span>()</span><br></pre></td></tr></table></figure></li>
<li>android stl,在源代码的<code>/platforms/android/build_sdk.py</code>(约113行)(非必须)<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">self.cmake_vars = dict(</span><br><span class="line">    ANDROID_STL=<span class="string">&quot;c++_static&quot;</span>, <span class="comment"># change `gnustl_static` to `c++_static` or `c++_shared`</span></span><br><span class="line">    ANDROID_ABI=self.name,</span><br><span class="line">    ANDROID_PLATFORM_ID=platform_id,</span><br><span class="line">)</span><br></pre></td></tr></table></figure></li>
<li>在<code>Android Studio</code>的android sdk文件夹下,创建软连接<code>ln -s build-tools/&#123;版本&#125; tools</code>,否则无法编译安卓模块</li>
</ul>
</li>
<li><p>修改<code>cmake</code>参数(2选1,推荐world)(修改根<code>CMakeLists.txt</code>)</p>
<ul>
<li>java<ul>
<li><code>OPENCV_ENABLE_NONFREE</code>:改为<code>ON</code></li>
<li><code>BUILD_SHARED_LIBS</code>:不动或者改为<code>OFF</code>,与生成java库冲突</li>
<li><code>BUILD_ANDROID_PROJECTS</code>:不动或者改为<code>ON</code></li>
<li><code>BUILD_FAT_JAVA_LIB</code>:不动或者改为<code>ON</code>,保证生成<code>libopencv_java4.so</code></li>
<li><code>BUILD_JAVA</code>:不动或者改为<code>ON</code></li>
<li>对<code>/samples/android/CMakeLists.txt</code>中除了<code>ocv_warnings_disable(CMAKE_CXX_FLAGS -Wmissing-declarations)</code>那一行,其他全部注释掉,否则android sdk会在编译sample时报错</li>
</ul>
</li>
<li>world<ul>
<li><code>OPENCV_ENABLE_NONFREE</code>:改为<code>ON</code></li>
<li><code>BUILD_SHARED_LIBS</code>:改为<code>ON</code></li>
<li><code>BUILD_ANDROID_PROJECTS</code>:不动或者改为<code>ON</code></li>
<li><code>BUILD_FAT_JAVA_LIB</code>:改为<code>OFF</code>,生成<code>libopencv_world.so</code></li>
<li><code>BUILD_JAVA</code>:不动或者改为<code>ON</code></li>
<li>对<code>/samples/android/CMakeLists.txt</code>中除了<code>ocv_warnings_disable(CMAKE_CXX_FLAGS -Wmissing-declarations)</code>那一行,其他全部注释掉,否则android sdk会在编译sample时报错</li>
</ul>
</li>
</ul>
</li>
<li><p>执行<code>platforms/android/build_sdk.py</code>,完成编译</p>
</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">./build_sdk.py --ndk_path &#123;ndk路径&#125; --sdk_path &#123;android sdk路径&#125; --extra_modules_path &#123;path_to_contrib/modules&#125; &#123;目标位置&#125; &#123;opencv源码位置&#125;</span><br><span class="line"><span class="comment"># example</span></span><br><span class="line">/home/lynx/fuck_mount/opencv_4_1_0/opencv-4.1.0/platforms/android/build_sdk.py --ndk_path /home/lynx/fuck_mount/Android/SDK/ndk/18.1.5063045 --sdk_path /home/lynx/fuck_mount/Android/SDK --extra_modules_path /home/lynx/fuck_mount/opencv/source_code/opencv_contrib_4_1_0/modules /home/lynx/fuck_mount/opencv_4_1_0/android_build /home/lynx/fuck_mount/opencv_4_1_0/opencv-4.1.0</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>如果没有设置则默认为环境变量</p>
<ul>
<li><code>sdk-path</code>:Android Studio的SDK目录</li>
<li><code>ndk-path</code>:Android Studio的SDK目录下<code>ndk/&#123;ndk版本号文件&#125;</code></li>
</ul>
<ol start="5">
<li>后续关于<code>CMakeLists.txt</code>(android项目内的)和<code>build.gradle</code>的修改同<code>native</code>方法</li>
</ol>
<h3 id="常见错误-1"><a href="#常见错误-1" class="headerlink" title="常见错误"></a>常见错误</h3><ol>
<li><code>java.lang.UnsatisfiedLinkError: dalvik.system.PathClassLoader[DexPathList[[zip file &quot;/data/app/com.example.stitch-sPWgBONIqUrdX9XLB1OY6w==/base.apk&quot;],nativeLibraryDirectories=[/data/app/com.example.stitch-sPWgBONIqUrdX9XLB1OY6w==/lib/arm64, /data/app/com.example.stitch-sPWgBONIqUrdX9XLB1OY6w==/base.apk!/lib/arm64-v8a, /system/lib64, /product/lib64]]] couldn&#39;t find &quot;libnative-lib.so&quot;</code></li>
</ol>
<p>缺少相应ABI的<code>so</code>库(目前计时在gradle里加入<code>abiFilters</code>也没有用),上述报错是因为没有编译全ABI.<code>ABI</code>配置:<code>opencv-4.x/platforms/android/ndk-18-api-level-21.config.py</code></p>
<ol start="2">
<li>没装<code>cmake</code></li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Executing: [&#39;ninja&#39;, &#39;--version&#39;]</span><br><span class="line">Failed: [Errno 2] No such file or directory</span><br></pre></td></tr></table></figure>

<p>Android Studio需要在SDK Manager里面预先安装<code>CMake</code>,否则编译的时候会找不到<code>ninja</code>等程序</p>
<ol start="3">
<li><p>没有<code>libopencv_java4.so</code></p>
<ul>
<li><code>BUILD_FAT_JAVA_LIB</code>和<code>BUILD_ANDROID_PROJECTS</code>要设置<code>ON</code>(或默认)</li>
<li>记得修改android sdk tools文件结构</li>
<li>不能同时编译动态库</li>
</ul>
</li>
<li><p>编译错误</p>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Regex: &#39;command line option .* is valid for .* but not for C\+\+&#39;</span><br></pre></td></tr></table></figure>

<p><strong>TODO</strong>,可能是编译器的问题或cmake参数设置错误</p>
<ol start="5">
<li>android project报错</li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">A problem occurred configuring project &#39;:face-detection&#39;.</span><br><span class="line">&gt; NDK not configured.</span><br><span class="line">  Download it with SDK manager.</span><br></pre></td></tr></table></figure>

<p>把<code>samples/android/CMakeLists.txt</code>对应代码注释掉</p>
<ol start="6">
<li>ndk报错</li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">CMake Error at &#x2F;home&#x2F;lynx&#x2F;fuck_mount&#x2F;Android_SDK&#x2F;ndk&#x2F;20.1.5948944&#x2F;build&#x2F;cmake&#x2F;android.toolchain.cmake:169 (message):</span><br><span class="line">  GCC is no longer supported.  See</span><br><span class="line">  https:&#x2F;&#x2F;android.googlesource.com&#x2F;platform&#x2F;ndk&#x2F;+&#x2F;master&#x2F;docs&#x2F;ClangMigration.md.</span><br></pre></td></tr></table></figure>

<p>需要将<code>ndk</code>的<code>build/cmake/android.toolchain.cmake</code>中<code>set(ANDROID_TOOLCHAIN gcc)</code>改为<code>clang</code></p>
<ol start="7">
<li>ninja报错</li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">CMake Error: CMake was unable to find a build program corresponding to &quot;Ninja&quot;.  CMAKE_MAKE_PROGRAM is not set.  You probably need to select a different build tool.</span><br></pre></td></tr></table></figure>

<p>将ndk的<code>bin</code>目录(包含<code>ninja</code>等程序)添加至<code>$PATH</code></p>
<ol start="8">
<li>ccache未安装(<code>3.x</code>版本,<strong>TODO</strong>:不确定是否为必须)</li>
</ol>
<p>用apt安装<code>ccache</code>即可</p>
<ol start="9">
<li>ld报错(<code>3.x</code>版本)</li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cannot open crtbegin_dynamic.o: 没有那个文件或目录</span><br><span class="line">cannot open crtend_android.o: 没有那个文件或目录</span><br><span class="line">cannot find -lstdc++</span><br><span class="line">cannot find -lm</span><br><span class="line">cannot find -lc</span><br><span class="line">cannot find -ldl</span><br></pre></td></tr></table></figure>

<p><strong>TODO</strong>修改<code>gcc</code>参数(但很大程度上是由于cmake参数配置错误)</p>
<ol>
<li>添加<code>-nostdlib</code></li>
<li>修改<code>--sysroot</code>参数</li>
</ol>
<ol start="10">
<li>clang++报错</li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">error while loading shared libraries: libtinfo.so.5: cannot open shared object file: No such file or directory</span><br></pre></td></tr></table></figure>

<p>使用apt安装<code>libtinfo5</code></p>
<ol start="11">
<li>编译错误</li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">error: use of undeclared identifier &#39;vcvt_f16_f32&#39;</span><br><span class="line">    float16x4_t v_dst &#x3D; vcvt_f16_f32(v_src);</span><br></pre></td></tr></table></figure>

<p>多种可能</p>
<ul>
<li>换<code>ndk</code></li>
<li><code>opencv_contrib</code>的路径设置错误</li>
</ul>
<ol start="12">
<li><code>libopencv_java3.so</code>没有生成(<code>3.x</code>版本)</li>
</ol>
<p><strong>TODO</strong>,很大程度上是由于cmake参数配置错误</p>
<ol start="13">
<li>cmake报错</li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Android SDK: Can&#39;t build Android projects as requested by</span><br><span class="line">  BUILD_ANDROID_PROJECTS&#x3D;ON variable.</span><br></pre></td></tr></table></figure>

<ul>
<li><code>4.x</code>:android sdk build tool版本过低</li>
<li><code>3.x</code>:需要sdk整合ant(ide为eclipse)</li>
</ul>
<ol start="14">
<li>java报错</li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">opencv init failed</span><br></pre></td></tr></table></figure>

<p>检查<code>gradle</code>的<code>lib</code>路径是否正确加载</p>
<ol start="15">
<li><code>freetype</code>/<code>harfbuzz</code>报错</li>
</ol>
<p>卸载系统中的<code>freetype</code>和<code>harfbuzz</code>在<code>opencv_contrib/modules/freetype/CMakeLists.txt</code>中修改</p>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(PKG_CONFIG_FOUND)</span><br><span class="line"><span class="comment"># pkg_search_module(FREETYPE freetype2)</span></span><br><span class="line"><span class="comment"># pkg_search_module(HARFBUZZ harfbuzz)</span></span><br><span class="line"><span class="keyword">endif</span>()</span><br></pre></td></tr></table></figure>

<p>注释掉搜索<code>freetype</code>和<code>harfbuzz</code>的那两句</p>
<h3 id="额外说明"><a href="#额外说明" class="headerlink" title="额外说明"></a>额外说明</h3><h4 id="4-x版本"><a href="#4-x版本" class="headerlink" title="4.x版本"></a><code>4.x</code>版本</h4><ul>
<li>不需要额外安装的软件:<code>jdk</code>,<code>ninja-build</code>,<code>ndk</code>,直接使用android studio的即可</li>
<li>成功编译的版本:<ul>
<li><code>ndk</code>:<code>20.1.5948944</code></li>
<li><code>sdk tools</code>:<code>28.0.3</code></li>
<li><code>cmake</code>:<code>3.13.4</code></li>
</ul>
</li>
<li>失败的版本:<ul>
<li><code>ndk</code>:<code>21.0.6113669</code>(报错<code>undefined referrence to &#39;__write_chk&#39;</code>)</li>
<li><code>sdk tools</code>:<code>25.0.3</code>(不能configure android project)</li>
</ul>
</li>
</ul>
<h4 id="3-x版本-目前还没能成功编译android-project"><a href="#3-x版本-目前还没能成功编译android-project" class="headerlink" title="3.x版本 目前还没能成功编译android project"></a><code>3.x</code>版本 目前还<strong>没能</strong>成功编译android project</h4><ul>
<li><code>3.x</code>成功编译的版本:<ul>
<li>无</li>
</ul>
</li>
<li>失败的版本:<ul>
<li><code>ndk</code>:<code>20.1.5948944</code>(报错<code>undefined referrence to &#39;__vsnprintf_chk&#39;</code>)</li>
</ul>
</li>
</ul>
<h2 id="使用JavaCV"><a href="#使用JavaCV" class="headerlink" title="使用JavaCV"></a>使用<code>JavaCV</code></h2><h3 id="4-x版本-1"><a href="#4-x版本-1" class="headerlink" title="4.x版本"></a><code>4.x</code>版本</h3><blockquote>
<p>不同导入方法,<code>import</code>的class位置可能不同</p>
</blockquote>
<h4 id="opencv部分功能的初始化"><a href="#opencv部分功能的初始化" class="headerlink" title="opencv部分功能的初始化"></a><code>opencv</code>部分功能的初始化</h4><p><a target="_blank" rel="noopener" href="https://github.com/bytedeco/javacpp-presets/tree/master/opencv#documentation">github原文</a></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Loader.load(opencv_java.class);// 不能直接放在class开头</span><br></pre></td></tr></table></figure>

<h4 id="使用远程导入"><a href="#使用远程导入" class="headerlink" title="使用远程导入"></a>使用远程导入</h4><p><code>app</code>的<code>build.gradle</code>示例(最外节点)</p>
<figure class="highlight gradle"><table><tr><td class="code"><pre><span class="line">ext &#123;</span><br><span class="line">    versions = [</span><br><span class="line">            <span class="string">&#x27;javacv&#x27;</span>: <span class="string">&#x27;1.4.4&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;ffmpeg&#x27;</span>: <span class="string">&#x27;4.1&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;opencv&#x27;</span>: <span class="string">&#x27;4.0.1&#x27;</span></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">dependencies</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">    implementation(<span class="keyword">group</span>: <span class="string">&#x27;org.bytedeco&#x27;</span>, name: <span class="string">&#x27;javacv-platform&#x27;</span>, version: versions.javacv) &#123;</span><br><span class="line">      <span class="keyword">exclude</span> <span class="keyword">group</span>: <span class="string">&#x27;org.bytedeco.javacpp-presets&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    implementation <span class="keyword">group</span>: <span class="string">&#x27;org.bytedeco.javacpp-presets&#x27;</span>, name: <span class="string">&#x27;ffmpeg&#x27;</span>, version: <span class="string">&quot;$&#123;versions.ffmpeg&#125;-$&#123;versions.javacv&#125;&quot;</span></span><br><span class="line">    implementation <span class="keyword">group</span>: <span class="string">&#x27;org.bytedeco.javacpp-presets&#x27;</span>, name: <span class="string">&#x27;ffmpeg&#x27;</span>, version: <span class="string">&quot;$&#123;versions.ffmpeg&#125;-$&#123;versions.javacv&#125;&quot;</span>, classifier: <span class="string">&#x27;android-arm&#x27;</span></span><br><span class="line">    implementation <span class="keyword">group</span>: <span class="string">&#x27;org.bytedeco.javacpp-presets&#x27;</span>, name: <span class="string">&#x27;ffmpeg&#x27;</span>, version: <span class="string">&quot;$&#123;versions.ffmpeg&#125;-$&#123;versions.javacv&#125;&quot;</span>, classifier: <span class="string">&#x27;android-arm64&#x27;</span></span><br><span class="line">    implementation <span class="keyword">group</span>: <span class="string">&#x27;org.bytedeco.javacpp-presets&#x27;</span>, name: <span class="string">&#x27;opencv&#x27;</span>, version: <span class="string">&quot;$&#123;versions.opencv&#125;-$&#123;versions.javacv&#125;&quot;</span></span><br><span class="line">    implementation <span class="keyword">group</span>: <span class="string">&#x27;org.bytedeco.javacpp-presets&#x27;</span>, name: <span class="string">&#x27;opencv&#x27;</span>, version: <span class="string">&quot;$&#123;versions.opencv&#125;-$&#123;versions.javacv&#125;&quot;</span>, classifier: <span class="string">&#x27;android-arm&#x27;</span></span><br><span class="line">    implementation <span class="keyword">group</span>: <span class="string">&#x27;org.bytedeco.javacpp-presets&#x27;</span>, name: <span class="string">&#x27;opencv&#x27;</span>, version: <span class="string">&quot;$&#123;versions.opencv&#125;-$&#123;versions.javacv&#125;&quot;</span>, classifier: <span class="string">&#x27;android-arm64&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="作为lib导入"><a href="#作为lib导入" class="headerlink" title="作为lib导入"></a>作为<code>lib</code>导入</h4><blockquote>
<p>根据手机具体的cpu架构进行导入</p>
</blockquote>
<p><code>app</code>的<code>build.gradle</code></p>
<figure class="highlight gradle"><table><tr><td class="code"><pre><span class="line"><span class="keyword">dependencies</span> &#123;</span><br><span class="line">    implementation <span class="keyword">fileTree</span>(dir: <span class="string">&#x27;libs&#x27;</span>, <span class="keyword">include</span>: [<span class="string">&#x27;*.jar&#x27;</span>])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>将文件(视具体情况)</p>
<ul>
<li><code>javacpp.jar</code></li>
<li><code>javacv.jar</code></li>
<li><code>openblas.jar</code></li>
<li><code>openblas-android-arm64.jar</code></li>
<li><code>opencv.jar</code></li>
<li><code>opencv-android-arm64.jar</code><br>复制到<code>app/libs/</code>文件夹里</li>
</ul>
<h3 id="常见错误-2"><a href="#常见错误-2" class="headerlink" title="常见错误"></a>常见错误</h3><ol>
<li>cpu架构错误/缺少(需添加<code>-android-arm</code>之类的库)</li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">2019-10-27 16:01:32.439 29256-29322&#x2F;? E&#x2F;AndroidRuntime: FATAL EXCEPTION: AsyncTask #1</span><br><span class="line">    Process: com.github.crazyorr.ffmpegrecorder, PID: 29256</span><br><span class="line">    java.lang.RuntimeException: An error occurred while executing doInBackground()</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>没有对<code>opencv</code>初始化</li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">2019-10-27 16:00:43.930 28933-28933&#x2F;? E&#x2F;AndroidRuntime: FATAL EXCEPTION: main</span><br><span class="line">    Process: com.example.javacv, PID: 28933</span><br><span class="line">    java.lang.UnsatisfiedLinkError: No implementation found for long org.opencv.core.Mat.n_Mat() (tried Java_org_opencv_core_Mat_n_1Mat and Java_org_opencv_core_Mat_n_1Mat__)</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>缺少<code>openblas</code>的相关<code>jar</code>库</li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">2019-10-27 15:59:23.158 28618-28618&#x2F;? E&#x2F;AndroidRuntime: FATAL EXCEPTION: main</span><br><span class="line">    Process: com.example.javacv, PID: 28618</span><br><span class="line">    java.lang.NoClassDefFoundError: Failed resolution of: Lorg&#x2F;bytedeco&#x2F;openblas&#x2F;presets&#x2F;openblas;</span><br></pre></td></tr></table></figure>

<h2 id="混用java-native模块"><a href="#混用java-native模块" class="headerlink" title="混用java+native模块"></a>混用<code>java</code>+<code>native</code>模块</h2><h3 id="4-x-native-或source-code-3-x-java"><a href="#4-x-native-或source-code-3-x-java" class="headerlink" title="4.x native(或source code)+3.x java"></a><code>4.x</code> <code>native</code>(或source code)+<code>3.x</code> <code>java</code></h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43815930/article/details/90516455">参考:CSDN</a></p>
<ol>
<li><p>加载<code>native</code>模块</p>
</li>
<li><p><code>File</code>-&gt;<code>New</code>-&gt;<code>Import Module</code>-&gt;选择opencv文件夹下的<code>sdk/java</code>文件夹,自己定义模块的名字</p>
</li>
<li><p>修改模块的gradle文件(<strong>TODO</strong>)</p>
</li>
</ol>
<figure class="highlight gradle"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 将原来的application改成library</span></span><br><span class="line">apply plugin: <span class="string">&#x27;com.android.library&#x27;</span></span><br><span class="line"></span><br><span class="line">android &#123;</span><br><span class="line">  <span class="comment">// 将版本信息改得和`app`的`build.gradle`一样</span></span><br><span class="line">  compileSdkVersion <span class="number">29</span></span><br><span class="line">  buildToolsVersion <span class="string">&quot;29.0.2&quot;</span></span><br><span class="line">  defaultConfig &#123;</span><br><span class="line">    <span class="comment">// 删除applicationId</span></span><br><span class="line">    minSdkVersion <span class="number">15</span></span><br><span class="line">    targetSdkVersion <span class="number">29</span></span><br><span class="line">    versionCode <span class="number">1</span></span><br><span class="line">    versionName <span class="string">&quot;1.0&quot;</span></span><br><span class="line">    testInstrumentationRunner <span class="string">&quot;androidx.test.runner.AndroidJUnitRunner&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 不改动</span></span><br><span class="line">  buildTypes &#123;</span><br><span class="line">    release &#123;</span><br><span class="line">      minifyEnabled <span class="keyword">false</span></span><br><span class="line">        proguardFiles getDefaultProguardFile(<span class="string">&#x27;proguard-android.txt&#x27;</span>), <span class="string">&#x27;proguard-rules.txt&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>修改app的gradle文件,加载两者的lib,缺一不可</li>
</ol>
<figure class="highlight gradle"><table><tr><td class="code"><pre><span class="line"><span class="keyword">sourceSets</span> &#123;</span><br><span class="line">  main &#123;</span><br><span class="line">    jniLibs.srcDirs = [<span class="string">&#x27;/home/lynx/fuck_mount/opencv/source_code/opencv_3_4_7_android/sdk/native/libs&#x27;</span>,</span><br><span class="line">              <span class="string">&#x27;/home/lynx/fuck_mount/opencv/build_dir/4_1_0_shared/OpenCV-android-sdk/sdk/native/libs&#x27;</span>]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="5">
<li>修改app的gradle文件,添加java模块依赖</li>
</ol>
<figure class="highlight gradle"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">dependencies</span> &#123;</span><br><span class="line">    implementation <span class="keyword">project</span>(path: <span class="string">&#x27;:openCVLibrary347&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h1><h2 id="OpenCV-source-code-3-x-3-4-7"><a href="#OpenCV-source-code-3-x-3-4-7" class="headerlink" title="OpenCV source code 3.x(3.4.7)"></a><code>OpenCV</code> source code <code>3.x</code>(<code>3.4.7</code>)</h2><h3 id="gui安装"><a href="#gui安装" class="headerlink" title="gui安装"></a>gui安装</h3><p>和<code>4.x</code>一样</p>
<h3 id="常见错误-3"><a href="#常见错误-3" class="headerlink" title="常见错误"></a>常见错误</h3><ol>
<li><p><code>fatal error: Eigen/Core: 没有那个文件或目录``#include &lt;Eigen/Core&gt;</code></p>
<ol>
<li><p>修改<code>WITH_EIGEN=OFF</code></p>
</li>
<li><p>(或)</p>
<ul>
<li>先保证安装<code>eigen</code>:<code>sudo apt install libeigen3-dev</code></li>
<li>添加<code>EIGEN_INCLUDE_PATH=/usr/include/eigen3</code>(视具体情况)</li>
</ul>
</li>
</ol>
</li>
<li><p><code>ippicv_linux_20141027.tgz</code>下载失败</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">CMake Error at 3rdparty&#x2F;ippicv&#x2F;downloader.cmake:71 (file):</span><br><span class="line">  file DOWNLOAD HASH mismatch</span><br><span class="line"></span><br><span class="line">    for file: [&#x2F;home&#x2F;lynx&#x2F;fuck_mount&#x2F;opencv_3_0_0&#x2F;opencv&#x2F;3rdparty&#x2F;ippicv&#x2F;downloads&#x2F;linux-8b449a536a2157bcad08a2b9f266828b&#x2F;ippicv_linux_20141027.tgz]</span><br><span class="line">      expected hash: [8b449a536a2157bcad08a2b9f266828b]</span><br><span class="line">        actual hash: [5c4f36bf7b2421d52289f0297ba1406f]</span><br><span class="line">             status: [28;&quot;Timeout was reached&quot;]</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p><strong>TODO</strong></p>
<ol start="3">
<li><p><code>ippicv_2019_lnx_intel64_general_20180723.tgz</code>下载超时</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">IPPICV: Download: ippicv_2019_lnx_intel64_general_20180723.tgz</span><br><span class="line">CMake Warning at cmake&#x2F;OpenCVDownload.cmake:193 (message):</span><br><span class="line">  IPPICV: Download failed: 28;&quot;Timeout was reached&quot;</span><br></pre></td></tr></table></figure>

<ol>
<li><p>在<code>opencv/opencv_3rdparty</code>的<code>ippicv</code>对应分支中下载对应的<code>tgz</code></p>
</li>
<li><p>将<code>tgz</code>放入<code>/home/lynx/Downloads/</code></p>
</li>
<li><p>修改opencv的source code: <code>vi /3rdparty/ippicv/ippicv.cmake</code>,将<code>ippicv</code>的<code>https</code>地址改为<code>file:/home/lynx/Downloads/</code></p>
</li>
<li><p>重新<code>cmake-gui</code></p>
</li>
</ol>
</li>
</ol>
<h2 id="OpenCV-source-code-4-x-4-1-0"><a href="#OpenCV-source-code-4-x-4-1-0" class="headerlink" title="OpenCV source code 4.x(4.1.0)"></a><code>OpenCV</code> source code <code>4.x</code>(<code>4.1.0</code>)</h2><h3 id="依赖包"><a href="#依赖包" class="headerlink" title="依赖包"></a>依赖包</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install libgtk2.0-dev pkg-config <span class="comment"># libgtk-3-dev</span></span><br></pre></td></tr></table></figure>

<p><strong>一定要安装</strong>,否则会报错</p>
<ul>
<li>缺少<code>gtk</code></li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">terminate called after throwing an instance of &#39;cv::Exception&#39;</span><br><span class="line">  what():  OpenCV(4.1.0) &#x2F;home&#x2F;lynx&#x2F;fuck_mount&#x2F;opencv&#x2F;source_code&#x2F;opencv_4_1_0&#x2F;modules&#x2F;highgui&#x2F;src&#x2F;window.cpp:610: error: (-2:Unspecified error) The function is not implemented. Rebuild the library with Windows, GTK+ 2.x or Cocoa support. If you are on Ubuntu or Debian, install libgtk2.0-dev and pkg-config, then re-run cmake or configure script in function &#39;cvNamedWindow&#39;</span><br></pre></td></tr></table></figure>

<h3 id="命令行安装-TODO"><a href="#命令行安装-TODO" class="headerlink" title="命令行安装(TODO)"></a>命令行安装(TODO)</h3><ol>
<li><code>cmake</code></li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> &#123;生成makefile的位置&#125;</span><br><span class="line">cmake &#123;<span class="built_in">source</span>的位置&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li><code>make</code></li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> &#123;生成makefile的位置&#125;</span><br><span class="line">make</span><br></pre></td></tr></table></figure>

<ol start="3">
<li><code>make install</code></li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">make install &#123;安装的位置&#125;</span><br></pre></td></tr></table></figure>

<h3 id="gui安装-1"><a href="#gui安装-1" class="headerlink" title="gui安装"></a>gui安装</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/u011897411/article/details/89743448#2CMAKE_INSTALL_PREFIX__101">参考:CSDN</a></p>
<ol>
<li>安装<code>cmake-gui</code></li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install cmake-gui</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>启动<code>cmake-gui</code></li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> &#123;build二进制文件的目录&#125;</span><br><span class="line">cmake-gui &#123;opencv <span class="built_in">source</span> code&#125;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li><p><code>Configure</code>-&gt;<code>Unix Makefiles</code>:<code>Use default native compilers</code>-&gt;<code>finish</code></p>
</li>
<li><p>狂点<code>Configure</code>直到没有红色区域</p>
</li>
<li><p>赋值</p>
</li>
</ol>
<table>
<thead>
<tr>
<th align="center">变量名</th>
<th align="center">赋值</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code>BUILD_EXAMPLES</code></td>
<td align="center"><del>勾选</del></td>
</tr>
<tr>
<td align="center"><code>CMAKE_BUILD_TYPE</code></td>
<td align="center"><code>Release</code></td>
</tr>
<tr>
<td align="center"><code>CMAKE_INSTALL_PREFIX</code></td>
<td align="center">{自己定的<code>cmake_install</code>路径}</td>
</tr>
<tr>
<td align="center"><code>OPENCV_ENABLE_NONFREE</code></td>
<td align="center">勾选</td>
</tr>
<tr>
<td align="center"><code>OPENCV_EXTRA_MODULES_PATH</code></td>
<td align="center"><code>&#123;opencv-contrib source code&#125;/modules</code></td>
</tr>
<tr>
<td align="center"><code>OPENCV_GENERATE_PKGCONFIG</code></td>
<td align="center">勾选</td>
</tr>
</tbody></table>
<ol start="6">
<li><p>狂点<code>Configure</code></p>
</li>
<li><p><code>Generate</code>,等到<code>Generating done</code></p>
</li>
<li><p>在build路径<code>make</code></p>
</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo make -j4 <span class="comment"># 具体看有多少cpu</span></span><br><span class="line">cat /proc/cpuinfo | grep <span class="string">&quot;processor&quot;</span> | wc -l <span class="comment"># 查看cpu个数</span></span><br><span class="line">sudo make install</span><br></pre></td></tr></table></figure>

<ol start="9">
<li><p>配置<code>opencv4.pc</code>(2选1)</p>
<ul>
<li>修改<code>PKG_CONFIG_PATH</code>:增加<code>&#123;你cmake_install的路径&#125;/lib/pkgconfig</code>(<code>opencv4.pc</code>所在的路径)</li>
<li>(TODO,没试过)复制<code>opencv4.pc</code>到<code>/usr/lib/pkgconfig</code></li>
</ul>
</li>
<li><p>配置库路径,(新建)<code>/etc/ld.so.conf.d/opencv.conf</code></p>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;你cmake_install路径&#125;&#x2F;lib&#x2F; # 自己的lib路径</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo ldconfig</span><br></pre></td></tr></table></figure>

<ol start="11">
<li>编译测试</li>
</ol>
<blockquote>
<p>如果是<code>opencv.pc</code>将<code>opencv4</code>改成<code>opencv</code></p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pkg-config --modversion opencv4</span><br><span class="line">g++ a.cpp `pkg-config --cflags --libs opencv4` -o <span class="built_in">test</span> &amp;&amp; ./<span class="built_in">test</span></span><br></pre></td></tr></table></figure>

<h3 id="常见问题-1"><a href="#常见问题-1" class="headerlink" title="常见问题"></a>常见问题</h3><ol>
<li>在其他项目中用<code>CMake</code>导入<code>OpenCV</code>模块:<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="keyword">find_package</span>(OpenCV REQUIRED)</span><br><span class="line"><span class="keyword">include_directories</span>(<span class="variable">$&#123;OpenCV_INCLUDE_DIRS&#125;</span>)</span><br></pre></td></tr></table></figure>
之后<code>cmake</code>出现<code>By not providing &quot;FindOpenCV.cmake&quot; in CMAKE_MODULE_PATH ...</code>:</li>
</ol>
<p>这是由于没有设置环境变量<code>OpenCV_DIR</code>,设置为<code>OpenCV</code>编译后的目录下含有<code>OpenCVConfig.cmake</code>的对应路径</p>
<ol start="2">
<li><code>VIDIOC_REQBUFS: Inappropriate ioctl for device</code>: 缺少ffmpeg</li>
</ol>
<p><strong>TODO</strong>: 需要在安装ffmpeg(以源代码的方式安装, 不要使用apt)之后重新编译OpenCV, <a href="/2020/11/24/ubuntu%E5%AE%89%E8%A3%85ffmpeg/">ffmpeg安装</a></p>

  
    
<script src="/js/guide.js"></script>

    <script>
      create_guide();
    </script>
  </div>
</div>

  
<script src="/js/main.js"></script>

  
<script src="/js/search.js"></script>

  
<script src="/js/highlight.js"></script>


</body>

</html>